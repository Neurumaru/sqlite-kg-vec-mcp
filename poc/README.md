# Proof of Concept

개인용 로컬 지식 베이스를 위한 SQLite 기반의 지식 그래프와 벡터 데이터베이스 통합 개념 증명입니다.

## 검증할 개념들

### 1. SQLite에서의 벡터 저장 및 검색 (sqlite-vector)
- vectorlite를 사용한 벡터 데이터 저장
  - 벡터 데이터 타입 정의 (256-512 차원)
  - 효율적인 벡터 저장 방식 선택
  - 경량 압축 방식 검토
- 벡터 유사도 검색 구현
  - 코사인 유사도 구현
  - 유클리디안 거리 구현
- 기본 인덱싱 구현
  - 단순화된 HNSW 인덱스
  - 메모리 사용량 최적화

### 2. 지식 그래프 구조 (sqlite-kg)
- 유연한 엔티티-관계 모델 구현
  - 엔티티 테이블 스키마
    - 간단한 ID 생성
    - 기본 메타데이터
  - 관계 테이블 스키마
    - 양방향 링크 지원
    - 태그 시스템 통합
  - 관찰 테이블 스키마
    - 시간 정보 저장
    - 간단한 버전 관리
- 기본 그래프 탐색 구현
  - 링크 기반 탐색
  - 태그 기반 필터링
  - 시간 기반 조회

### 3. 설명 벡터화 및 검색 (sqlite-desc-vec)
- 텍스트 처리 파이프라인
  - 기본 전처리
  - 임베딩 생성
  - 키워드 추출
- 의미 기반 검색 구현
  - 유사도 검색
  - 퍼지 매칭
  - 자연어 쿼리 지원
- 하이브리드 검색 구현
  - 벡터 + 키워드 검색
  - 벡터 + 태그 검색
  - 검색 결과 병합

### 4. MCP 서버 기본 구현 (mcp-base)
- 경량 서버 구현
  - 기본 설정 관리
  - 간단한 로깅
  - 메모리 관리
- 핵심 명령어 처리
  - 지식 베이스 조작
  - 검색 명령어
  - 에러 처리

### 5. MCP 서버 통합 (mcp-integration)
- 지식 그래프 명령어
  - 노트 CRUD
  - 링크 관리
  - 태그 관리
- 검색 명령어
  - 의미 검색
  - 키워드 검색
  - 필터 검색
- 통합 테스트
  - 기본 시나리오
  - 성능 테스트

### 6. MCP 서버 테스트 방법론 (how-to-test-mcp)
- 단위 테스트 구현
  - 메시지 처리 테스트
  - 명령어 처리 테스트
  - 에러 처리 테스트
- 통합 테스트 구현
  - 실제 MCP 클라이언트 연동
  - Claude와의 통신 테스트
  - 명령어 시퀀스 테스트
- 테스트 데이터 관리
  - 테스트용 지식 그래프 생성
  - 테스트용 벡터 데이터 생성
  - 테스트 시나리오 관리

## 테스트 데이터셋
- 엔티티: 5,000개
- 관계: 10,000개
- 관찰: 50,000개
- 설명: 5,000개
- 벡터 차원: 384
- 총 데이터 크기: 100MB 이하

## 성능 요구사항

1. **벡터 저장 및 검색**
   - 384 차원 벡터 효율적 저장
   - 검색 응답 시간 < 200ms
   - 인덱스 크기 < 원본 데이터 크기
   - 처리량: 5 QPS

2. **지식 그래프 구조**
   - 일관성 있는 데이터 관리
   - 그래프 탐색 응답 < 100ms
   - 5만 트리플 처리 가능
   - 처리량: 10 QPS

3. **설명 벡터화 및 검색**
   - 텍스트 벡터화 < 500ms
   - 검색 정확도 > 70% (Top-5)
   - 하이브리드 검색 < 300ms
   - 처리량: 3 QPS

4. **MCP 서버**
   - 명령어 처리 < 50ms
   - 에러 복구 < 1s
   - 메모리 사용: 최대 1GB
   - CPU 사용: 평균 20% 이하

## 개발 환경
- Python 3.11+
- SQLite 3.45.0+
- vectorlite 최신 버전
- FastMCP 최신 버전
- pytest 테스트 프레임워크

## 디렉토리 구조
```
poc/
├── sqlite-vector/     # 벡터 저장 및 검색 테스트
├── sqlite-kg/         # 지식 그래프 구조 테스트
├── sqlite-desc-vec/   # 설명 벡터화 및 검색 테스트
├── mcp-base/         # MCP 서버 기본 기능 테스트
└── mcp-integration/   # MCP 서버 통합 테스트
```

## 검증 순서

1. **벡터 저장 및 검색 (sqlite-vector)**
   - vectorlite 라이브러리 기본 기능 검증
   - 벡터 데이터 CRUD 작업 테스트
   - 벡터 유사도 검색 성능 측정

2. **지식 그래프 구조 (sqlite-kg)**
   - 기본 스키마 설계 및 검증
   - 엔티티-관계 모델 구현
   - 그래프 쿼리 구현 및 테스트

3. **설명 벡터화 및 검색 (sqlite-desc-vec)**
   - 설명 텍스트 벡터화 파이프라인 구현
   - 벡터화된 설명 저장 및 검색
   - 하이브리드 검색 (벡터 + 그래프) 테스트

4. **MCP 서버 기본 구현 (mcp-base)**
   - FastMCP 서버 기본 구조 구현
   - 기본 MCP 명령어 처리 검증
     - 서버 정보 요청
     - 상태 확인
     - 기본 에러 처리
   - 서버 라이프사이클 관리 테스트
     - 시작/종료
     - 연결 관리
     - 세션 관리

5. **MCP 서버 통합 (mcp-integration)**
   - 지식 그래프 명령 처리기 구현
   - 벡터 검색 명령 처리기 구현
   - 통합 테스트 시나리오 실행

6. **MCP 서버 테스트 방법론 (how-to-test-mcp)**
   - 단위 테스트 구현
     - 메시지 처리 테스트
     - 명령어 처리 테스트
     - 에러 처리 테스트
   - 통합 테스트 구현
     - 실제 MCP 클라이언트 연동
     - Claude와의 통신 테스트
     - 명령어 시퀀스 테스트
   - 테스트 데이터 관리
     - 테스트용 지식 그래프 생성
     - 테스트용 벡터 데이터 생성
     - 테스트 시나리오 관리

## 성공 기준

1. **벡터 저장 및 검색**
   - 1M 차원 이하의 벡터를 효율적으로 저장
   - 밀리초 단위의 유사도 검색 응답
   - 인덱스 크기가 원본 데이터의 2배 이하

2. **지식 그래프 구조**
   - 엔티티-관계-관찰 데이터의 일관성 유지
   - 그래프 순회 쿼리의 효율적인 처리
   - 대량의 트리플 데이터 처리 가능

3. **설명 벡터화 및 검색**
   - 설명 텍스트의 효과적인 벡터 변환
   - 의미적 유사도에 기반한 검색 정확도
   - 벡터 검색과 그래프 검색의 원활한 통합

4. **MCP 서버 기본 구현**
   - FastMCP 서버 정상 작동
   - 기본 MCP 명령어 정상 처리
   - 서버 상태 관리 정상 작동
   - 에러 상황 적절한 처리
   - 연결 및 세션 관리 안정성

5. **MCP 서버 통합**
   - 지식 그래프 명령어 정상 처리
   - 벡터 검색 명령어 정상 처리
   - 전체 시스템 통합 동작
   - 성능 요구사항 충족 